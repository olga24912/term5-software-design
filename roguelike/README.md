# Roguelike

## Правила игры

* Обозначения:
    * 'I' - игровой персонаж.
    * 'M' - моб, совершает случайные передвижания, и если Вы оказываетесь рядом, то убивает Вас.
    * 'T' - тул, который вам необходимо собрать. Он просто лежит и ничего не делает.
    * '.' - пустая клетка по которой можно ходить.
    * '-' - стенка, по ней ходить нельзя
    * '|' - тоже стенка, по которой так же нельзя ходить.
    * '#' - коридор в другую комнату, по которому можно ходить.
    * ' ' - неизвестная клетка.

* Цель и правила игры:
    * Ваша цель собрать все тулы и убить всех мобов.
    * Если вас убил моб - Вы проиграли.
    * Вы ходите раньше мобов.
    * Моб видет как вы походили и его действия пологаются на текущую конфигурацию.

* Управление:
    * 'w' - передвинуть человечка наверх
    * 's' - передвинуть человечка вниз
    * 'd' - передвинуть человечка вправо
    * 'a' - передвинуть человечка влево
    * 'l' - повзоимодействовать(убить моба или взять тул) с объектом справа
    * 'j' - повзоимодействовать с объектом слева
    * 'k' - повзоимодействовать с объектом снизу
    * 'i' - повзоимодействовать с объектом сверху
    * 'h' - показать подсказки по управлению.
    * 't' - показать количество тулов в багаже
    * 'c' - продолжить играть, если находишься в режиме подсказки или просмотра тулов.

## Описание архитектуры:

* Main точка входа. Вызывает controller и на этом его роль заканчивается.

* Используется архитектурный шаблон "Model-View-Controller"
    * (пакет view) В данном случае View реализован через Swing, как моделяция терминала.
    * (пакет controller) Controller - прослойка между View и Model. Вызывает нужную функцию отрисовки в зависимости
    от состояния и реагирует на нажатие клавиш.
    * (пакет model) Model - это что-то более интелектуальное, поговорим о нем подробнее.

* Модель.
    * Класса State - состояние игры.
        * В себе содержит карту(map) и поле GameState.
        * Отвечает за смену состояний(идет игра, показывается подсказка, режим выбора тулов, игра выграна, игра проигрына)
         игры в процессе развития событий.
        * В этом классе создается новая игра.

    * Класс Map. Карта игры.
        * Карта игры создается в конструкторе State.
        * В себе хранит несколько слоев.
            * SimpleMap - статическая карта, просто с описанием какие
            клетки пустые, а какие занятые.
            * visibility - какие клетки видет главный персонаж.
            * objects - объекты, которые могут совершать ход(мобы или тулы), персонаж там не хранится.
            * character - главные ходячий персонаж.
        * Что происходит в Map
            * Из State вызывается функция в Map doTerm. При ее вызове
            все действующие лица начиная с главного персонажа делают свое действие.
            * Так же из функций есть shoot. Какие-то герои могут выстрелить в конкретную
            клетку, тогда в map находят всех существ, которые на этой клетке стоят и просят
            отреагировать на этот выстрел. Например, мобы умерают, а тулы переезжают в богаж
            стрелявшому. Если объект после выстрела оказался мерт, то он удаляется из объетов
            карты.
            * Из интреснго, так же map может вернуть карту на отрисовку, getMapToPresent - здесь
            все слои накладываются друг на друго и возращается то, что можно рисовать.

    * Что бы создать карту используется Паттерн Builder. А именно класс mapBuilder.
        * В нем можно задать конфигурацию игры. Внутри этого паттерна используется
        паттерн Стратегии.

    * Обратим внимание на классы вида MapGenerator. Этот класс передается в
    builder и отвечает за разные способы генерации карты.
    В данном паттерне появилась необходимость на момент тестирование, так как
    тестироовать на более простых картах куда легче и это был наиболее простой способ
    как задавать метод генерации.
    В данном случае представленны две стратегии
        * BfsMapGenerator - основная стратегия для генерации карты.
        * SimpleMapGenerator - генерирует просто одну комнату.

    * Осталось сказать только про GameObject. Это все объекты,
    которые умеют находиться на карте. Они все умеют
        * реагировать на какой-то контакт с ними
        * делать ход
        * говорить, как их отрисовывать.
        * знают свои координаты. 